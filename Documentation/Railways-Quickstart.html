<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Railways Quickstart</title>
<style><!-- 
body {
	margin-left: 10%;
	margin-right: 10%;
	padding: 20pt;
	padding-top: 10pt;
	background: rgb(255,255,255);
	font:  10.5pt/15pt "Helvetica",Helvetica,sans-serif;
	color: rgb(80,80,80);
}

h1, h2, h3, h4 {
	font-family: "Trebuchet MS",Helvetica,sans-serif;
	color: rgb(22, 130, 178);
	font-weight: normal;
	padding-top: 0.5em;
	cursor: pointer;
}

hr {
	color: rgb(150, 220, 238);
	background: rgb(150, 220, 238);
	height: 1px;
	border: 0;
}


b {
	color: rgb(22,130,178);
}

strong {
	color: rgb(103,183,0);
}


a:link, a:active, a:visited {
	color: rgb(22,130,178);
	text-decoration: none;
}

a:hover {
	text-decoration: none;
	background-color: #dbecf4;
}

aimg {
	border: 0;
}

#header, #footer {
	font-size: 7pt;
	clear: both;
	width: 100%;
	color: rgb(177,208,223);
}

.kiwiContent {
	text-align: left;
}


#footer {
	padding-top:  30pt;
	text-align: right;
}

/*  Kiwi-specific  */

.title {
	margin-bottom: 0;
}

.kiwiMeta {
	max-width: 700px;
	padding: 5pt;
	margin-bottom:  2em;
	border-top:  1px solid rgb(150, 220, 238);
	background-color: rgb(250,250,250);
}

.kiwiMeta tr td {
	color: rgb(22, 130, 178);
}

.kiwiMeta tr td.name {
	font-weight: bold;
}

.kiwiContent {
	max-width: 700px;
}

.kiwiContent .heading .number {
	padding-right: 8pt;
}

.kiwiContent .heading .number .lastDot {
	display: none;
}


.kiwiContent .heading .number .level0 .lastDot {
	display: inline;
}

.kiwiContent h1 {
	font-size: 1.8em;
	font-weight: bold;
	margin-top: 1.5em;
	padding-bottom: 0.5em;
	border-bottom:  1px dotted rgb(150, 220, 238);
}

.kiwiContent h2 {
	font-size: 1.4em;
	font-weight: bold;
	padding-bottom: 0.5em;
	border-bottom:  1px dotted rgb(150, 220, 238);
}

.kiwiContent h3 {
	font-size: 1.2em;
	font-weight: normal;
}

.kiwiContent pre {
	padding: 5pt;
	border:  1px solid rgb(150, 220, 238);
	padding-left: 20pt;
	background-color: rgb(240,240,250);
	font-size: 8pt;
	color: rgb(22,130,178);
}

.kiwiContent code {
	font-size: 8pt;
	background-color: rgb(240,240,250);
}

.kiwiContent dt {
	color: rgb(22,130,178);
	font-weight: bold;
}

.kiwiContent dd {
	border-left:  1px solid rgb(150, 220, 238);
	padding-left: 20pt;
	margin-bottom: 2em;
}

.kiwiContent dd pre {
	border-left: 0px;
}

.kiwiContent ul {
	padding-top: 0em;
	margin-top: 0em;
}

.kiwiContent ul li {
	padding-bottom: 0.2em;
}

.kiwiContent ul li.todo {
	list-style-type: square;
}

.kiwiContent ul li.todo.done {
	text-decoration: line-through;
}

.kiwiContent table {
	border:  1px solid rgb(150, 220, 238);
	padding: 0pt;
}

.kiwiContent table caption {
	font-family: serif;
	padding-top: 1em;
	padding-bottom: 0.5em;
	font-style: italic;
	font-size: 90%;
	color: rgb(22, 130, 178);
}

.kiwiContent table tbody {
}

.kiwiContent table tr {
	margin: 0;
}

.kiwiContent table tr td {
	margin: 0;
	padding: 5pt;
	font-size: 90%;
	min-width: 125px;
	background-color: rgb(250,250,250);
	border-bottom: 1px solid rgb(150, 220, 238);
}

.kiwiContent table tr td.lastRow {
	border-bottom: none;
}

.kiwiContent table tr td.lastCol {
	border-right: none;
}

.kiwiContent table tr.even td {
	background-color: #FEFEFE;

}

.kiwiContent table tr.odd td {
	background-color: rgb(240,240,240);
}

.kiwiContent .term {
	color: rgb(22, 130, 178);
	background: rgb(240, 250, 256);
}

.kiwiContent .quote {
	font-style: italic;
	color: rgb(120, 120, 120);
}

.kiwiContent .citation {
	font-style: italic;
	color: rgb(120, 120, 120);
}

.kiwiContent div[class^="ann"] {
	margin-top: 5pt;
	margin-bottom: 5pt;
	padding: 5pt;
	padding-left: 20pt;
	color: rgb(100, 100, 100);
}

.kiwiContent div[class^="ann"] .title {
	font-weight: bold;
}

.kiwiContent .annNote {
	border:  1px solid rgb(103,183,0);
	margin-top: 5pt;
	margin-bottom: 5pt;
	padding: 5pt;
	padding-left: 20pt;
	background: #fffbe4;
	color: rgb(100, 100, 100);
	border:  1px solid #dedac3;
}

.kiwiContent .annNote .title {
	font-weight: bold;
	display: none;
}

.kiwiReferences {
	font:  8pt/12pt "Lucida Grande",Lucida,sans-serif;
	margin-top: 10pt;
	padding: 5pt;
	border-top:  1px solid rgb(200, 200, 200);
	background-color: rgb(250,250,250);
	color: rgb(200, 200, 200);
	font-size: 8pt;
}
.kiwiReferences a:link, .kiwiReferences a:active, .kiwiReferences a:visited {
	color: rgb(150,150,150);
}

.kiwiReferences .entry {
	padding-top: 5pt;
	clear: both;
}

.kiwiReferences .entry .name {
	float: left;
	font-weight: bold;
	padding-right: 5pt;
}

.kiwiReferences .entry .content {
	text-align: right;
}

 --></style>
</head>
<body>
<div
	class="title"><h1>Railways Quickstart</h1><h2>Version 0.5.1</h2></div>
<div class="kiwiContent"><div class='content'><p><span class='term'>Railways</span> is a lightweight Python Web WSGI-based framework that is designed for easy of prototyping and simplicity. The only purpose of Railways is to offer a simple architecture that allows you to write Web services and applications in a very RESTful style.</p><p>The main role of Railways is to provide you with an easy way of mapping URLs to your Python code and offer you nice OO abstractions to the HTTP protocol. Railways takes advantage of newer Python features such as <span class='term'>decorators</span> to give you a concise, declarative way of turning your Python code into web services and applications.</p><p>In this short tutorial we'll walk through the most important steps of creating a web application, leaving out the details to the API reference.</p><div class="section"><h1 class="heading"><span class="number"><span class="level0">1<span class="lastDot dot">.</span></span></span>Creating a server</h1><div class="level1"><p>The first step is to import the Railways symbols into your namespace:</p><pre>from railways import *</pre><p>As Railways has a component-based architecture (your web application will be made of components), you have to write a &ldquo;<span class='quote'>main</span>&rdquo; component. You do this by subclassing the <code>railways.Component</code> class, which you just imported:</p><pre>class Main(Component):
	def __init__( self ):
		Component.__init__(self, name="My first application")</pre><p>We will add functionality to the component later. In the meantime, let's test the component by using the 'railways.run' function in the module main:</p><pre>if __name__ == "__main__":
	my_app = Application()
	my_app.register(Main())
	run(app=my_app, port=8080)</pre><p>Now, if your start your module, you will see this on your command line:</p><pre>Railways embedded server listening on 0.0.0.0:8080</pre><p>and you can visit <a href="http://localhost:8080/">http://localhost:8080/</a> and see the following message:</p><pre>405 Method Not Supported</pre><p>This is normal, because you've not setup any <em>mapping</em> between URLs and your application&hellip;</p></div></div><div class="section"><h1 class="heading"><span class="number"><span class="level0">2<span class="lastDot dot">.</span></span></span>Mapping URLs</h1><div class="level1"><p>To be able to server pages and content in your application, you have to express a mapping between URL and actual methods of your components.</p><p>In Railways, you define a mapping by <span class='term'>exposing</span> a method of your component using the <code>@on</code> decorator:</p><pre>class Main(Component):
	...
	@on(GET="/index")
	def index( self, request ):
		return request.respond("Hello, world !")</pre><p>Here, we've defined the 'index' method (the name is not important), and <span class='term'>exposed</span> to react to a <code>GET</code> HTTP method sent to the <code>/index</code> URL. Restarting your server and going to <a href="http://localhost:8080/index">http://localhost:8080/index</a> will give you this text:</p><pre>Hello, world !</pre><p>The <code>@on</code> decorator parameters are made of the following elements:</p><ul><li>a <span class='term'>parameter name</span> (like <code>GET</code>, <code>POST</code>, <code>GET_POST</code>), where the HTTP methods are uppercase and joined by underscores</li></ul><ul><li>a <span class='term'>parameter value</span>, which is an expression that defines matching URLs.</li></ul><ul><li>an optional <code>priority</code>, which allows one mapping with higher priority to be used in preference when more than one mapping matches the URL.</li></ul><p>The parameter value expression can contain specific parts that will be matched and given as arguments to the decorated method:</p><pre>	@on(GET="/int/{i:integer}")
	def getInteger(self, request, i):
		return request.respond("Here is number %d" % (i))</pre><p>Now, if you go to <a href="http://localhost:8080/int/0">http://localhost:8080/int/0</a>, or <a href="http://localhost:8080/int/1">http://localhost:8080/int/1</a>, <a href="http://localhost:8080/int/2">http://localhost:8080/int/2</a>, you will see these numbers printed out.</p><p>Generally speaking, anything between <code>{</code> and <code>}</code> in parameter expressions will be interpreted as a <span class='term'>matching argument</span>. The format is like that:</p><pre>{ NAME : EXPRESSION }</pre><p>where <code>NAME</code> must match an argument of the decorated method, and where 'EXPRESSION' is either a regular expression (as of Python 're' module), or one of the following values:</p><ul><li><code>word</code>, <code>alpha</code>: any sequence of alphabetical chars </li><li><code>string</code>: everything that is not a <code>/</code> </li><li><code>digits</code>: a sequence of digits, cast to an <code>int</code> </li><li><code>number</code>: a floating point or an int, negative or positive </li><li><code>int</code>, <code>integer</code>: an int, negative or positive </li><li><code>float</code>: an float, negative or positive </li><li><code>file</code>: two alphanumeric words joined by a dot </li><li><code>chunk</code>: everything which is neither a <code>/</code> nor a <code>.</code> </li><li><code>rest</code>, <code>any</code> : the rest of the URL </li><li><code>range</code>: two integers joined by <code>:</code> (Python-style)</li></ul><p>Once you have your mapping right, you may want to do more complicated things with your exposed methods&hellip; and we'll see in the next section what we can do with the mysterious 'request' parameter.</p></div></div><div class="section"><h1 class="heading"><span class="number"><span class="level0">3<span class="lastDot dot">.</span></span></span>The Request object</h1><div class="level1"><p>The <code>railways.core.Request</code> class defines a class that represents an HTTP request. The <code>request</code> parameter we've seen in the previous section is an instance of this class, that represents the request sent by the client browser and received by the Railways server.</p><p>The request object offers different kind of functionalities:</p><ul><li>Accessing the request parameters, cookies and data: whether <code>POST</code> or <code>GET</code>, whether url-encoded or form-encoded, parameters and attachments are retrievable using the <code>param</code>, <code>cookies</code> and <code>data</code> methods.</li></ul><ul><li>Accessing request method, headers and various information: TODO</li></ul><ul><li>Creating a response: the request object contains methods to create specific responses, whether it is serving a local file, returning JSON data, redirecting, returning an error, or simply returning specific content. These methods are mainly <code>respond</code>, <code>returns</code>, <code>redirect</code>, <code>bounce</code>, <code>notFound</code>, <code>localFile</code>.</li></ul><p>In practice, you need only to know a few things. First, how to get access to parameters.</p><p>Say you have a request to that URL:</p><pre>http://localhost:8080/api/doThis?a=1&amp;b=2</pre><p>and that you have a handler bound to <code>/api/doThis</code>, here is how you would get access to a and b:</p><pre>@on(GET_POST='/api/doThis')
def doThis( self, request ):
	a = request.get('a')
	b = request.get('b')
	if a is None or b is None:
		return request.respond(
			"You must give proper 'a' and 'b' parameters",
			status=400
		)
	else:
		return request.respond(
			"Here a:%s and here is b:%s" % (a,b)
		)</pre><p>This is the simplest, and most common case. Now if you want to receive a file that was <code>POST</code>ed by the client, by a form like this one:</p><pre>&lt;form action="/api/postThis" method="POST"&gt;
	&lt;input type="text" name="name" value="File name" /&gt;
	&lt;input type="file" name="file" value="Upload file" /&gt;
&lt;/form&gt;</pre><p>you would do the following:</p><pre>@on(POST='/api/postThis')
def postThis( self, request ):
	file_name = request.get('name')
	file_data = request.get('file')
	file_info = request.file('file')
	return request.respond(
		"Received file %s, of %s bytes, with content type:%s" %
		(file_info.get("filename"),len(file_data),file_info.get("contentType"))
	)</pre><p>we see here that the file data is available as any other parameter, but that we can use the <code>request.file</code> method to get more information about the file, like its content type and original filename.</p><div class='annNote'><div class='title'>Note</div><div class='content'>
	It is important to note that <em>you must return the result</em> of the
	<code>request.[respond, returns, redirect, bounce, ...]</code> methods. These methods
	actually return a generator that will be used by Railways to produce the
	content of the response.</div></div></div></div><div class="section"><h1 class="heading"><span class="number"><span class="level0">4<span class="lastDot dot">.</span></span></span>Sessions management</h1><div class="level1"><p>Session management is another important aspect of web applications. Railways session manage is provided by Alan Saddi's <a href="#FLUP">FLUP</a> session middleware and is easily accessible through the request object <code>session</code></p></div></div><div class="section"><h1 class="heading"><span class="number"><span class="level0">5<span class="lastDot dot">.</span></span></span>AJAXify your code</h1><div class="level1"></div></div><div class="section"><h1 class="heading"><span class="number"><span class="level0">6<span class="lastDot dot">.</span></span></span>Components architecture</h1><div class="level1"></div></div><div class="section"><h1 class="heading"><span class="number"><span class="level0">7<span class="lastDot dot">.</span></span></span>Integration with Apache</h1><div class="level1"></div></div></div></div>
<div class="kiwiReferences"><div class="entry"><div class="name"><a name="FLUP">FLUP</a></div><div class="content"> FLUP, random WSGI stuff, Alan Saddi, <a href="http://trac.saddi.com/flup">http://trac.saddi.com/flup</a></div></div></div>
</body>
</html>